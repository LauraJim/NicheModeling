---
title: "Input Data"
author: "Laura Jimen√©z and Carola Franzen"
date: "July 2021"
output: html_document
fontsize: 12pt
linkcolor: dodgerblue4
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(raster)
library(sp)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)

```
\
  
\

# Input data and parameters
\
For the tutorials of this package, specific data and parameters are necessary. They will be explained here for reference.
<!-- write more blabla here -->

\

## Collected Data

The collected data are rasters and tables related to a species of interest and study focus. They will be the basic input data that is necessary to create the parameters for the functions.
\

### Occurrence observations of species

The tables used for this package are matrices that contain the location information of a species observation. Only presence data is used as absence data plays no role for the models employed.

Occurrence data is available on various open databases. For all examples, data from [GBIF](https://www.gbif.org/) was used. However, the tables from GBIF need to be cleaned up before they can be used as the database is aggregated from various sources with different formats and can contain various errors. There are packages available that aid in the cleaning of the data (e.g. see [CoordinateCleaner]( https://ropensci.github.io/CoordinateCleaner/articles/Cleaning_GBIF_data_with_CoordinateCleaner.html)).

The tables for the examples have been cleaned and contain three columns: species name, longitude, latitude. These occurrence tables with three columns are called `G.occ`.

```{r}
# table with a species occurrence  
G.occ <- read.csv("./Input_Data/Catasticta_nimbice_occ_G.csv",header=T)
head(G.occ, n=3)

G.occ2 <- read.csv("./Input_Data/Threnetes_ruckeri_occ_G.csv",header=T)
head(G.occ2, n=3)

```
\

### Rasters with environmental information

The raster files for the functions of this package need to contain information on climatic values that are of interest for the user. The rasters used in the examples are from [WorldClim](https://worldclim.org/data/index.html) and have a resolution of "10 minutes". The files usually do not need further editing.

For our examples, we used the raster of the American continent. The environmental conditions of interest are the *mean annual temperature*, called `bio1` and the the *total mean precipitation*, called `bio12`.

```{r}
# raster for mean annual temperature
bio1 <- raster("./Input_Data/bio1WH.asc")
# raster for mean total precipitation
bio12 <- raster("./Input_Data/bio12WH.asc")

spplot(bio1)
plot(bio12)

```
\

### Polygons of the study area
The functions often use a polygon of the region of interest either to serve as a boundary in plots or to delimit rasters or sampled points to the specific region. The polygons used in the examples are shapefiles.

```{r, message=FALSE}
cn.shp <- readOGR("./Initial_Data/shapefiles","nimbice3")
thr.shp <- readOGR("./Initial_Data/shapefiles","Threnetes_ruckeri")
```
```{r}
# ggplot of shapefile

    # transform polygon into WGS 84
    M <- spTransform(cn.shp, CRS("+proj=longlat +datum=WGS84"))
    # This function turns a map into a data frame that can more easily be 
    # plotted with ggplot2.
    M <- fortify(M)
    # takes id that is a "character" and converts it to a number
    M$id = as.numeric(M$id)
# Sets the boundaries to which the worldmap is cut
    Mext <- extent(cn.shp)
    # worldmap is added from the rnaturalearth packages
    world <- ne_countries(scale = "medium", returnclass = "sf")
    class(world)
    
    # plot in ggplot
    ggplot(data = world) +
      geom_sf( ) +
      theme_bw() +
      # alpha -> transparency of polygon, 0.1 = high, 0.5 = medium transparency
      geom_map(map=M, data=M, aes(map_id=id), color= "springgreen3", fill = "springgreen3", 
               alpha = 0.4) +
      coord_sf(xlim = c(Mext[1] - 10 ,Mext[2] + 10), 
               ylim = c(Mext[3] - 10,Mext[4] + 10), expand = FALSE) +
      theme(panel.grid.major = element_line(color = "white"),
            panel.background = element_rect(fill = "aliceblue"))
```


## Generated Data

The generated data (matrices, rasters, etc.) are based on the collected data files and created by using functions of this package.

### Tables

* Gcoord = a matrix with only longitude and latitude data of species observations
\

* GE.occ = a matrix that contains coordinates and environmental information that corresponds to the occurrence data (created with the function `get.Ecoord`)
\

* 


### Rasters
* cropped
* stacked