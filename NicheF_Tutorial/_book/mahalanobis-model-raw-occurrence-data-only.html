<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Mahalanobis model: raw occurrence data only | Index</title>
  <meta name="description" content="5 Mahalanobis model: raw occurrence data only | Index" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Mahalanobis model: raw occurrence data only | Index" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Mahalanobis model: raw occurrence data only | Index" />
  
  
  

<meta name="author" content="Laura Jiménez and Carola Franzen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"/>
<link rel="next" href="plotting-an-ellipsoid-in-e-space.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#organization-within-the-tutorial"><i class="fa fa-check"></i><b>1.0.1</b> Organization within the tutorial</a></li>
<li class="chapter" data-level="1.0.2" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.0.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html"><i class="fa fa-check"></i><b>2</b> Description of initial datasets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#species-under-study-and-necessary-files-to-start-an-analysis"><i class="fa fa-check"></i><b>2.1</b> Species under study and necessary files to start an analysis</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#occurrence-data"><i class="fa fa-check"></i><b>2.1.1</b> Occurrence data</a></li>
<li class="chapter" data-level="2.1.2" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#points-inside-the-study-area-to-plot-hutchinsons-duality"><i class="fa fa-check"></i><b>2.1.2</b> Points inside the study area to plot Hutchinson’s duality</a></li>
<li class="chapter" data-level="2.1.3" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#table-with-species-tolerance-limit"><i class="fa fa-check"></i><b>2.1.3</b> Table with species’ tolerance limit</a></li>
<li class="chapter" data-level="2.1.4" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#polygons-of-the-study-area"><i class="fa fa-check"></i><b>2.1.4</b> Polygons of the study area</a></li>
<li class="chapter" data-level="2.1.5" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#rasters-with-environmental-information"><i class="fa fa-check"></i><b>2.1.5</b> Rasters with environmental information</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><i class="fa fa-check"></i><b>3</b> Extracting environmental data from raster files from a set of geographic coordinates</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#parameters"><i class="fa fa-check"></i><b>3.0.1</b> Parameters</a></li>
<li class="chapter" data-level="3.0.2" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#input-and-output"><i class="fa fa-check"></i><b>3.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="3.0.3" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#dependencies"><i class="fa fa-check"></i><b>3.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="3.1" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#worked-examples"><i class="fa fa-check"></i><b>3.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#read-source-code-and-libraries"><i class="fa fa-check"></i><b>3.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="3.1.2" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#catasticta-nimbice"><i class="fa fa-check"></i><b>3.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="3.1.3" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#threnetes-ruckeri"><i class="fa fa-check"></i><b>3.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><i class="fa fa-check"></i><b>4</b> Creating plots with the geographical and environmental space of a species in ggplot2</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#parameters-1"><i class="fa fa-check"></i><b>4.0.1</b> Parameters</a></li>
<li class="chapter" data-level="4.0.2" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#input-and-output-1"><i class="fa fa-check"></i><b>4.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="4.0.3" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#dependencies-1"><i class="fa fa-check"></i><b>4.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="4.1" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#worked-examples-1"><i class="fa fa-check"></i><b>4.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#read-source-code-and-libraries-1"><i class="fa fa-check"></i><b>4.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="4.1.2" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#catasticta-nimbice-1"><i class="fa fa-check"></i><b>4.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="4.1.3" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#threnetes-ruckeri-1"><i class="fa fa-check"></i><b>4.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html"><i class="fa fa-check"></i><b>5</b> Mahalanobis model: raw occurrence data only</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#input-and-output-2"><i class="fa fa-check"></i><b>5.0.1</b> Input and Output</a></li>
<li class="chapter" data-level="5.0.2" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#dependencies-2"><i class="fa fa-check"></i><b>5.0.2</b> Dependencies</a></li>
<li class="chapter" data-level="5.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#worked-examples-2"><i class="fa fa-check"></i><b>5.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#read-source-code-and-libraries-2"><i class="fa fa-check"></i><b>5.1.1</b> Read Source Code and Libraries</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#threnetes-ruckeri---example-with-two-environmental-layers"><i class="fa fa-check"></i><b>5.2</b> <em>Threnetes ruckeri</em> - example with two environmental layers</a></li>
<li class="chapter" data-level="5.3" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#catasticta-nimbice-2"><i class="fa fa-check"></i><b>5.3</b> <em>Catasticta nimbice</em></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#get-environmental-information-from-three-raster-layers"><i class="fa fa-check"></i><b>5.3.1</b> 1) Get environmental information from three raster layers</a></li>
<li class="chapter" data-level="5.3.2" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#estimate-mahalanobis-model-parameters"><i class="fa fa-check"></i><b>5.3.2</b> 2) Estimate Mahalanobis Model Parameters</a></li>
<li class="chapter" data-level="5.3.3" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#calculate-suitability-index"><i class="fa fa-check"></i><b>5.3.3</b> 3) Calculate Suitability Index</a></li>
<li class="chapter" data-level="5.3.4" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#comparing-suitability-index-against-mahalanobis-distance"><i class="fa fa-check"></i><b>5.3.4</b> 3) Comparing suitability index against Mahalanobis distance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html"><i class="fa fa-check"></i><b>6</b> Plotting an ellipsoid in E-space</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#parameters-2"><i class="fa fa-check"></i><b>6.0.1</b> Parameters</a></li>
<li class="chapter" data-level="6.0.2" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#input-and-output-3"><i class="fa fa-check"></i><b>6.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="6.0.3" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#dependencies-3"><i class="fa fa-check"></i><b>6.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="6.1" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#worked-examples-3"><i class="fa fa-check"></i><b>6.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#read-source-code-and-library"><i class="fa fa-check"></i><b>6.1.1</b> Read source code and library</a></li>
<li class="chapter" data-level="6.1.2" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#example-with-three-ellipses-threnetes-ruckeri"><i class="fa fa-check"></i><b>6.1.2</b> Example with three ellipses (<em>Threnetes ruckeri</em>)</a></li>
<li class="chapter" data-level="6.1.3" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#example-with-several-ellipses-catasticta-nimbice"><i class="fa fa-check"></i><b>6.1.3</b> Example with several ellipses (<em>Catasticta nimbice</em>)</a></li>
<li class="chapter" data-level="6.1.4" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#example-with-three-environmental-variables-catasticta-nimbice"><i class="fa fa-check"></i><b>6.1.4</b> Example with three environmental variables (<em>Catasticta nimbice</em>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><i class="fa fa-check"></i><b>7</b> How to simulate a random sample of environmental conditions inside an region</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#parameters-3"><i class="fa fa-check"></i><b>7.0.1</b> Parameters</a></li>
<li class="chapter" data-level="7.0.2" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#input-and-output-4"><i class="fa fa-check"></i><b>7.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="7.0.3" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#dependencies-4"><i class="fa fa-check"></i><b>7.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="7.1" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#worked-examples-4"><i class="fa fa-check"></i><b>7.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#read-source-code-and-libraries-3"><i class="fa fa-check"></i><b>7.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="7.1.2" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#catasticta-nimbice-3"><i class="fa fa-check"></i><b>7.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="7.1.3" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#threnetes-ruckeri-2"><i class="fa fa-check"></i><b>7.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><i class="fa fa-check"></i><b>8</b> How to identify points inside and outside the fundamental niche</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#parameters-4"><i class="fa fa-check"></i><b>8.0.1</b> Parameters</a></li>
<li class="chapter" data-level="8.0.2" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#input-and-output-5"><i class="fa fa-check"></i><b>8.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="8.0.3" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#dependencies-5"><i class="fa fa-check"></i><b>8.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="8.1" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#worked-examples-5"><i class="fa fa-check"></i><b>8.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#read-source-code-and-library-1"><i class="fa fa-check"></i><b>8.1.1</b> Read source code and library</a></li>
<li class="chapter" data-level="8.1.2" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#threnetes-ruckeri-3"><i class="fa fa-check"></i><b>8.1.2</b> <em>Threnetes ruckeri</em></a></li>
<li class="chapter" data-level="8.1.3" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#catasticta-nimbice-4"><i class="fa fa-check"></i><b>8.1.3</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="8.1.4" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#theoretical-example"><i class="fa fa-check"></i><b>8.1.4</b> Theoretical Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><i class="fa fa-check"></i><b>9</b> Weighted-normal model: accounting for the uneven availability of environmental conditions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#how-the-functions-work"><i class="fa fa-check"></i><b>9.1</b> How the functions work</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#parameters-5"><i class="fa fa-check"></i><b>9.1.1</b> Parameters</a></li>
<li class="chapter" data-level="9.1.2" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#input-and-output-6"><i class="fa fa-check"></i><b>9.1.2</b> Input and Output</a></li>
<li class="chapter" data-level="9.1.3" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#dependencies-6"><i class="fa fa-check"></i><b>9.1.3</b> Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#worked-examples-6"><i class="fa fa-check"></i><b>9.2</b> Worked examples</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#read-sources-and-libraries"><i class="fa fa-check"></i><b>9.2.1</b> Read sources and libraries</a></li>
<li class="chapter" data-level="9.2.2" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#catasticta-nimbice-5"><i class="fa fa-check"></i><b>9.2.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="9.2.3" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#threnetes-ruckeri-4"><i class="fa fa-check"></i><b>9.2.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html"><i class="fa fa-check"></i><b>10</b> Projecting an estimated niche into G-space</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#parameters-6"><i class="fa fa-check"></i><b>10.0.1</b> Parameters</a></li>
<li class="chapter" data-level="10.0.2" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#input-and-output-7"><i class="fa fa-check"></i><b>10.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="10.0.3" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#dependencies-7"><i class="fa fa-check"></i><b>10.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="10.1" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#worked-examples-7"><i class="fa fa-check"></i><b>10.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#read-source-code-and-libraries-4"><i class="fa fa-check"></i><b>10.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="10.1.2" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#catasticta-nimbice-6"><i class="fa fa-check"></i><b>10.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="10.1.3" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#threnetes-ruckeri-5"><i class="fa fa-check"></i><b>10.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html"><i class="fa fa-check"></i><b>11</b> Evaluation method: building accumulation curve of occurrences</a>
<ul>
<li class="chapter" data-level="11.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#calculate-the-accumulation-curve"><i class="fa fa-check"></i><b>11.1</b> Calculate the accumulation curve</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#parameters-7"><i class="fa fa-check"></i><b>11.1.1</b> Parameters</a></li>
<li class="chapter" data-level="11.1.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#input-and-output-8"><i class="fa fa-check"></i><b>11.1.2</b> Input and Output</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#worked-examples-8"><i class="fa fa-check"></i><b>11.2</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#read-libraries-and-source-codes"><i class="fa fa-check"></i><b>11.2.1</b> Read libraries and source codes</a></li>
<li class="chapter" data-level="11.2.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#catasticta-nimbice-with-three-environmental-layers"><i class="fa fa-check"></i><b>11.2.2</b> <em>Catasticta nimbice</em> with three environmental layers</a></li>
<li class="chapter" data-level="11.2.3" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#threnetes-ruckeri-with-two-environmental-layers"><i class="fa fa-check"></i><b>11.2.3</b> <em>Threnetes ruckeri</em> with two environmental layers</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#comparing-the-accumulation-curves"><i class="fa fa-check"></i><b>11.3</b> Comparing the accumulation curves</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#parameters-8"><i class="fa fa-check"></i><b>11.3.1</b> Parameters</a></li>
<li class="chapter" data-level="11.3.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#input-and-output-9"><i class="fa fa-check"></i><b>11.3.2</b> Input and Output</a></li>
<li class="chapter" data-level="11.3.3" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#worked-example-threnetes-ruckeri"><i class="fa fa-check"></i><b>11.3.3</b> Worked example: <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html"><i class="fa fa-check"></i><b>12</b> Bayesian model: adding tolerance limits</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#how-the-main-functions-work"><i class="fa fa-check"></i><b>12.1</b> How the main functions work</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#parameters-9"><i class="fa fa-check"></i><b>12.1.1</b> Parameters</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#input-and-output-10"><i class="fa fa-check"></i><b>12.1.2</b> Input and Output</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#dependencies-8"><i class="fa fa-check"></i><b>12.1.3</b> Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#worked-example-threnetes-ruckeri-1"><i class="fa fa-check"></i><b>12.2</b> Worked Example: <em>Threnetes ruckeri</em></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#read-source-codes-and-libraries"><i class="fa fa-check"></i><b>12.2.1</b> Read source codes and libraries</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#main-code"><i class="fa fa-check"></i><b>12.2.2</b> Main code</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#using-the-bayesian-model-for-the-projection-into-g-space"><i class="fa fa-check"></i><b>12.3</b> Using the Bayesian model for the projection into G-Space</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#read-source-and-libraries"><i class="fa fa-check"></i><b>12.3.1</b> Read source and libraries</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Index</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mahalanobis-model-raw-occurrence-data-only" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Mahalanobis model: raw occurrence data only</h1>
<!-- description -->
<p><br />
</p>
<div id="input-and-output-2" class="section level3" number="5.0.1">
<h3><span class="header-section-number">5.0.1</span> Input and Output</h3>
<p>In order to calculate the Mahalanobis distance and Mahalanobis model, mu and Sigma (covariance) of variables are necessary. This could, for example be the environmental data that has been correlated to the geographic occurrence data of a species.</p>
<p>The output of mu and Sigma can be further processed into an ellipse or a suitability map.</p>
</div>
<div id="dependencies-2" class="section level3" number="5.0.2">
<h3><span class="header-section-number">5.0.2</span> Dependencies</h3>
<p><strong>Functions:</strong> <code>dismo</code>, <code>raster</code></p>
<p><strong>Examples:</strong> <code>rgdal</code>, <code>tools</code>, <code>sp</code></p>
</div>
<div id="worked-examples-2" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Worked Examples</h2>
<div id="read-source-code-and-libraries-2" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Read Source Code and Libraries</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;.</span><span class="sc">\\</span><span class="st">Functions</span><span class="sc">\\</span><span class="st">getEcoord.R&quot;</span>)</span>
<span id="cb53-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;.</span><span class="sc">\\</span><span class="st">Functions</span><span class="sc">\\</span><span class="st">nicheG.R&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dismo)</span>
<span id="cb54-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb54-3"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb54-4"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span>
<span id="cb54-5"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb54-6"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-7"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div>
</div>
</div>
<div id="threnetes-ruckeri---example-with-two-environmental-layers" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> <em>Threnetes ruckeri</em> - example with two environmental layers</h2>
<p><strong>Input Data</strong></p>
<ul>
<li>Threnetes_ruckeri_occ_GE.csv</li>
</ul>
<p>Read table with environmental data that are the basis for the calculation of the Mahalanobis distance.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb55-1" aria-hidden="true" tabindex="-1"></a>thr.occ_E <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Generated_Data/Threnetes_ruckeri_occ_GE.csv&quot;</span>,<span class="at">header=</span>T)[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span></code></pre></div>
<p>The centroid is calculated by taking the means of the two columns (<code>mu</code>) in the matrix with two environmental layers. This parameter will set the values of the maximum likelihood estimate.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb56-1" aria-hidden="true" tabindex="-1"></a>(center <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(thr.occ_E))</span></code></pre></div>
<pre><code>##      bio1     bio12 
##  244.7135 2894.1345</code></pre>
<p>Calculate the covariance of the environmental data (<code>Sigma</code>).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb58-1" aria-hidden="true" tabindex="-1"></a>(boundary <span class="ot">&lt;-</span> <span class="fu">cov</span>(thr.occ_E))</span></code></pre></div>
<pre><code>##             bio1     bio12
## bio1    420.7939  -1367.22
## bio12 -1367.2201 816368.46</code></pre>
<p>Here, add example on how to plot the principal axis of the estimated ellipse (use this example: )</p>
</div>
<div id="catasticta-nimbice-2" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> <em>Catasticta nimbice</em></h2>
<div id="get-environmental-information-from-three-raster-layers" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> 1) Get environmental information from three raster layers</h3>
<p><strong>Input Data</strong></p>
<ul>
<li><p>Catasticta_nimbice_occ_G.csv</p></li>
<li><p>cn_bio1_cropped.tif</p></li>
<li><p>cn_bio6_cropped.tif</p></li>
<li><p>cn_bio12_cropped.tif</p></li>
</ul>
<p>Read necessary files from the Generated_Data folder for <em>Catasticta nimbice</em>: a matrix with coordinates of species observations (latitude and longitude) and the three (cropped) raster layers for bio1, bio6, and bio12.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read occurrence data</span></span>
<span id="cb60-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb60-2" aria-hidden="true" tabindex="-1"></a>occ_G <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Initial_Data/Catasticta_nimbice_occ_G.csv&quot;</span>,<span class="at">header=</span>T)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb60-3"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># read raster files</span></span>
<span id="cb60-5"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb60-5" aria-hidden="true" tabindex="-1"></a>bio1cn <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;./Generated_Data/cn_bio1_cropped.tif&quot;</span>)</span>
<span id="cb60-6"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb60-6" aria-hidden="true" tabindex="-1"></a>bio6cn <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;./Generated_Data/cn_bio6_cropped.tif&quot;</span>)</span>
<span id="cb60-7"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb60-7" aria-hidden="true" tabindex="-1"></a>bio12cn <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;./Generated_Data/cn_bio12_cropped.tif&quot;</span>)</span></code></pre></div>
<p>Prepare the parameters: create a rasterstack of the cropped environmental layers and create a vector with the environmental layer names.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stack the layers</span></span>
<span id="cb61-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb61-2" aria-hidden="true" tabindex="-1"></a>bios <span class="ot">&lt;-</span> <span class="fu">stack</span>(bio1cn, bio6cn, bio12cn)</span>
<span id="cb61-3"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector with names in same order as stack</span></span>
<span id="cb61-4"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb61-4" aria-hidden="true" tabindex="-1"></a>E.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;bio1&quot;</span>, <span class="st">&quot;bio6&quot;</span>, <span class="st">&quot;bio12&quot;</span>)</span></code></pre></div>
<p>Apply function</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb62-1" aria-hidden="true" tabindex="-1"></a>cn.GE3 <span class="ot">&lt;-</span> <span class="fu">get.Ecoord</span>(<span class="at">Estck =</span> bios, <span class="at">Gcoord =</span> occ_G, <span class="at">Enames =</span> E.names)</span>
<span id="cb62-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cn.GE3, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>##   Longitude Latitude bio1 bio6 bio12
## 1 -96.50500 16.06139  191  111  1249
## 2 -96.50083 16.16944  175   89  1029
## 3 -96.57000 16.31722  175   89  1029
## 4 -92.63844 16.62883  185  107  1309</code></pre>
<p>Write as csv</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(cn.GE3,<span class="at">file=</span><span class="fu">paste0</span>(<span class="st">&quot;./Generated_Data/Catasticta_nimbice_occ_GE3.csv&quot;</span>),</span>
<span id="cb64-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb64-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> F)</span></code></pre></div>
<p><strong>Output Data</strong></p>
<ul>
<li>Catasticta_nimbice_occ_GE3.csv</li>
</ul>
</div>
<div id="estimate-mahalanobis-model-parameters" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> 2) Estimate Mahalanobis Model Parameters</h3>
<p><strong>Input Data</strong></p>
<ul>
<li>Catasticta_nimbice_occ_GE3.csv</li>
</ul>
<p>Prepare parameters for the function <code>niche.G</code>. For this, a table with only the variables is necessary.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb65-1" aria-hidden="true" tabindex="-1"></a>occ_E <span class="ot">&lt;-</span> cn.GE3[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span></code></pre></div>
<p>The centroid is calculated by taking the means of the two columns in the matrix (<code>mu</code>). This parameter will set the values of the maximum likelhood estimate.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb66-1" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(occ_E)</span></code></pre></div>
<p>Calculate the covariance of the environmental data (<code>Sigma</code>).</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb67-1" aria-hidden="true" tabindex="-1"></a>boundary <span class="ot">&lt;-</span> <span class="fu">cov</span>(occ_E)</span></code></pre></div>
</div>
<div id="calculate-suitability-index" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> 3) Calculate Suitability Index</h3>
<p>Apply function</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb68-1" aria-hidden="true" tabindex="-1"></a>cn.maha <span class="ot">&lt;-</span> <span class="fu">niche.G</span>(<span class="at">Estck =</span> bios, <span class="at">mu =</span> center, <span class="at">Sigma =</span> boundary)</span></code></pre></div>
<p>Save resulting raster. This file will be necessary for further calculations.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(cn.maha, <span class="st">&quot;./Generated_Data/cn_maha3_cropped.tif&quot;</span>, <span class="at">overwrite=</span> T) </span></code></pre></div>
<p>Plot.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cn.maha)</span></code></pre></div>
<p><img src="04_Mahalanobis_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p><strong>Output Data</strong></p>
<ul>
<li>Catasticta_nimbice_maha3_cropped.tif</li>
</ul>
</div>
<div id="comparing-suitability-index-against-mahalanobis-distance" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> 3) Comparing suitability index against Mahalanobis distance</h3>
<p>The Mahalanobis distance and the suitability index calculated with the Mahalanobis model are slightly different. If applied to the raster cells, the patterns can turn out similar, they are however different.</p>
<p><strong>Input Data</strong></p>
<ul>
<li>Catasticta_nimbice_maha3_cropped.tif</li>
</ul>
<p>Calculate the Mahalanobis distance and apply it to the cells.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb71-1" aria-hidden="true" tabindex="-1"></a>maha.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(cell){</span>
<span id="cb71-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb71-2" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cell, <span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb71-3"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb71-3" aria-hidden="true" tabindex="-1"></a>    sui.ind <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(<span class="at">x=</span> X, <span class="at">center=</span> center, <span class="at">cov=</span> boundary)</span>
<span id="cb71-4"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(sui.ind)</span>
<span id="cb71-5"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb71-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-6"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb71-7" aria-hidden="true" tabindex="-1"></a>maha.map <span class="ot">&lt;-</span> <span class="fu">calc</span>(bios,<span class="at">fun=</span>maha.fun)</span></code></pre></div>
<p>For easier comparison, the Mahalanobis distance and the Mahalanobis model rasters are plotted in ggplot.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-1" aria-hidden="true" tabindex="-1"></a>ext <span class="ot">&lt;-</span> <span class="fu">extent</span>(<span class="sc">-</span><span class="dv">120</span>, <span class="sc">-</span><span class="dv">75</span>, <span class="dv">0</span>, <span class="dv">35</span>)</span>
<span id="cb72-2"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mahalanobis distance</span></span>
<span id="cb72-4"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate raster to points for ggplot</span></span>
<span id="cb72-5"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-5" aria-hidden="true" tabindex="-1"></a>mahamap.p <span class="ot">&lt;-</span> <span class="fu">rasterToPoints</span>(maha.map)</span>
<span id="cb72-6"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-6" aria-hidden="true" tabindex="-1"></a>mahamap.pd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mahamap.p)</span>
<span id="cb72-7"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mahamap.pd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Maha&quot;</span>)</span>
<span id="cb72-8"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb72-10"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>(<span class="at">data =</span> mahamap.pd,<span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, <span class="at">fill=</span>Maha)) <span class="sc">+</span></span>
<span id="cb72-11"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-12"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(ext[<span class="dv">1</span>], ext[<span class="dv">2</span>]),</span>
<span id="cb72-13"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(ext[<span class="dv">3</span>],ext[<span class="dv">4</span>]), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-14"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_gradient2</span>(<span class="st">&quot;Mahalanobis distance&quot;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), </span>
<span id="cb72-15"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">low =</span> <span class="st">&#39;royalblue3&#39;</span>, <span class="at">mid=</span><span class="st">&#39;seagreen3&#39;</span>, <span class="at">high =</span> <span class="st">&#39;gold2&#39;</span>,</span>
<span id="cb72-16"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">na.value =</span> <span class="cn">NA</span>, <span class="at">midpoint =</span> <span class="dv">50</span>, <span class="at">n.breaks=</span><span class="dv">6</span>)</span>
<span id="cb72-17"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Suitability index</span></span>
<span id="cb72-19"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate raster to points for ggplot</span></span>
<span id="cb72-20"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-20" aria-hidden="true" tabindex="-1"></a>mahasuit.p <span class="ot">&lt;-</span> <span class="fu">rasterToPoints</span>(cn.maha)</span>
<span id="cb72-21"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-21" aria-hidden="true" tabindex="-1"></a>mahasuit.pd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mahasuit.p)</span>
<span id="cb72-22"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mahasuit.pd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Suitability&quot;</span>)</span>
<span id="cb72-23"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb72-25"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_tile</span>(<span class="at">data =</span> mahasuit.pd,<span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, <span class="at">fill=</span>Suitability)) <span class="sc">+</span></span>
<span id="cb72-26"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-27"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(ext[<span class="dv">1</span>], ext[<span class="dv">2</span>]),</span>
<span id="cb72-28"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(ext[<span class="dv">3</span>],ext[<span class="dv">4</span>]), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-29"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_gradient2</span>(<span class="st">&quot;Suitability index&quot;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb72-30"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">low =</span> <span class="st">&#39;royalblue3&#39;</span>, <span class="at">mid=</span><span class="st">&#39;seagreen3&#39;</span>, <span class="at">high =</span> <span class="st">&#39;gold2&#39;</span>,</span>
<span id="cb72-31"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-31" aria-hidden="true" tabindex="-1"></a>                             <span class="at">na.value =</span> <span class="cn">NA</span>, <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">n.breaks=</span><span class="dv">6</span>)</span>
<span id="cb72-32"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="co"># x11()</span></span>
<span id="cb72-33"><a href="mahalanobis-model-raw-occurrence-data-only.html#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">1.38</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">1.38</span>))</span></code></pre></div>
<p>This example clearly shows that both methods are using the Mahalanobis distance but produce different results. On the left side, the Mahalanobis distance, the lower values show the area of importance (close to 0), while on the right hand side, the suitability index calculated with the Mahalanobis model shows important areas in higher values (close to 1)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="Images/Maharas_compare.png" alt=" Figure of the differently calculated rasters." width="100%" />
<p class="caption">
Figure 5.1:  Figure of the differently calculated rasters.
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-an-ellipsoid-in-e-space.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
