<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Projecting an estimated niche into G-space | Index</title>
  <meta name="description" content="10 Projecting an estimated niche into G-space | Index" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Projecting an estimated niche into G-space | Index" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Projecting an estimated niche into G-space | Index" />
  
  
  

<meta name="author" content="Laura Jiménez and Carola Franzen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"/>
<link rel="next" href="evaluation-method-building-accumulation-curve-of-occurrences.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#organization-within-the-tutorial"><i class="fa fa-check"></i><b>1.0.1</b> Organization within the tutorial</a></li>
<li class="chapter" data-level="1.0.2" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.0.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html"><i class="fa fa-check"></i><b>2</b> Description of initial datasets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#species-under-study-and-necessary-files-to-start-an-analysis"><i class="fa fa-check"></i><b>2.1</b> Species under study and necessary files to start an analysis</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#occurrence-data"><i class="fa fa-check"></i><b>2.1.1</b> Occurrence data</a></li>
<li class="chapter" data-level="2.1.2" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#points-inside-the-study-area-to-plot-hutchinsons-duality"><i class="fa fa-check"></i><b>2.1.2</b> Points inside the study area to plot Hutchinson’s duality</a></li>
<li class="chapter" data-level="2.1.3" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#table-with-species-tolerance-limit"><i class="fa fa-check"></i><b>2.1.3</b> Table with species’ tolerance limit</a></li>
<li class="chapter" data-level="2.1.4" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#polygons-of-the-study-area"><i class="fa fa-check"></i><b>2.1.4</b> Polygons of the study area</a></li>
<li class="chapter" data-level="2.1.5" data-path="description-of-initial-datasets.html"><a href="description-of-initial-datasets.html#rasters-with-environmental-information"><i class="fa fa-check"></i><b>2.1.5</b> Rasters with environmental information</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><i class="fa fa-check"></i><b>3</b> Extracting environmental data from raster files from a set of geographic coordinates</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#parameters"><i class="fa fa-check"></i><b>3.0.1</b> Parameters</a></li>
<li class="chapter" data-level="3.0.2" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#input-and-output"><i class="fa fa-check"></i><b>3.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="3.0.3" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#dependencies"><i class="fa fa-check"></i><b>3.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="3.1" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#worked-examples"><i class="fa fa-check"></i><b>3.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#read-source-code-and-libraries"><i class="fa fa-check"></i><b>3.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="3.1.2" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#catasticta-nimbice"><i class="fa fa-check"></i><b>3.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="3.1.3" data-path="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html"><a href="extracting-environmental-data-from-raster-files-from-a-set-of-geographic-coordinates.html#threnetes-ruckeri"><i class="fa fa-check"></i><b>3.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><i class="fa fa-check"></i><b>4</b> Creating plots with the geographical and environmental space of a species in ggplot2</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#parameters-1"><i class="fa fa-check"></i><b>4.0.1</b> Parameters</a></li>
<li class="chapter" data-level="4.0.2" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#input-and-output-1"><i class="fa fa-check"></i><b>4.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="4.0.3" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#dependencies-1"><i class="fa fa-check"></i><b>4.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="4.1" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#worked-examples-1"><i class="fa fa-check"></i><b>4.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#read-source-code-and-libraries-1"><i class="fa fa-check"></i><b>4.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="4.1.2" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#catasticta-nimbice-1"><i class="fa fa-check"></i><b>4.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="4.1.3" data-path="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html"><a href="creating-plots-with-the-geographical-and-environmental-space-of-a-species-in-ggplot2.html#threnetes-ruckeri-1"><i class="fa fa-check"></i><b>4.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html"><i class="fa fa-check"></i><b>5</b> Mahalanobis model: raw occurrence data only</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#input-and-output-2"><i class="fa fa-check"></i><b>5.0.1</b> Input and Output</a></li>
<li class="chapter" data-level="5.0.2" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#dependencies-2"><i class="fa fa-check"></i><b>5.0.2</b> Dependencies</a></li>
<li class="chapter" data-level="5.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#worked-examples-2"><i class="fa fa-check"></i><b>5.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#read-source-code-and-libraries-2"><i class="fa fa-check"></i><b>5.1.1</b> Read Source Code and Libraries</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#threnetes-ruckeri---example-with-two-environmental-layers"><i class="fa fa-check"></i><b>5.2</b> <em>Threnetes ruckeri</em> - example with two environmental layers</a></li>
<li class="chapter" data-level="5.3" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#catasticta-nimbice-2"><i class="fa fa-check"></i><b>5.3</b> <em>Catasticta nimbice</em></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#get-environmental-information-from-three-raster-layers"><i class="fa fa-check"></i><b>5.3.1</b> 1) Get environmental information from three raster layers</a></li>
<li class="chapter" data-level="5.3.2" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#estimate-mahalanobis-model-parameters"><i class="fa fa-check"></i><b>5.3.2</b> 2) Estimate Mahalanobis Model Parameters</a></li>
<li class="chapter" data-level="5.3.3" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#calculate-suitability-index"><i class="fa fa-check"></i><b>5.3.3</b> 3) Calculate Suitability Index</a></li>
<li class="chapter" data-level="5.3.4" data-path="mahalanobis-model-raw-occurrence-data-only.html"><a href="mahalanobis-model-raw-occurrence-data-only.html#comparing-suitability-index-against-mahalanobis-distance"><i class="fa fa-check"></i><b>5.3.4</b> 3) Comparing suitability index against Mahalanobis distance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html"><i class="fa fa-check"></i><b>6</b> Plotting an ellipsoid in E-space</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#parameters-2"><i class="fa fa-check"></i><b>6.0.1</b> Parameters</a></li>
<li class="chapter" data-level="6.0.2" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#input-and-output-3"><i class="fa fa-check"></i><b>6.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="6.0.3" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#dependencies-3"><i class="fa fa-check"></i><b>6.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="6.1" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#worked-examples-3"><i class="fa fa-check"></i><b>6.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#read-source-code-and-library"><i class="fa fa-check"></i><b>6.1.1</b> Read source code and library</a></li>
<li class="chapter" data-level="6.1.2" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#example-with-three-ellipses-threnetes-ruckeri"><i class="fa fa-check"></i><b>6.1.2</b> Example with three ellipses (<em>Threnetes ruckeri</em>)</a></li>
<li class="chapter" data-level="6.1.3" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#example-with-several-ellipses-catasticta-nimbice"><i class="fa fa-check"></i><b>6.1.3</b> Example with several ellipses (<em>Catasticta nimbice</em>)</a></li>
<li class="chapter" data-level="6.1.4" data-path="plotting-an-ellipsoid-in-e-space.html"><a href="plotting-an-ellipsoid-in-e-space.html#example-with-three-environmental-variables-catasticta-nimbice"><i class="fa fa-check"></i><b>6.1.4</b> Example with three environmental variables (<em>Catasticta nimbice</em>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><i class="fa fa-check"></i><b>7</b> How to simulate a random sample of environmental conditions inside an region</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#parameters-3"><i class="fa fa-check"></i><b>7.0.1</b> Parameters</a></li>
<li class="chapter" data-level="7.0.2" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#input-and-output-4"><i class="fa fa-check"></i><b>7.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="7.0.3" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#dependencies-4"><i class="fa fa-check"></i><b>7.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="7.1" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#worked-examples-4"><i class="fa fa-check"></i><b>7.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#read-source-code-and-libraries-3"><i class="fa fa-check"></i><b>7.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="7.1.2" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#catasticta-nimbice-3"><i class="fa fa-check"></i><b>7.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="7.1.3" data-path="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html"><a href="how-to-simulate-a-random-sample-of-environmental-conditions-inside-an-region.html#threnetes-ruckeri-2"><i class="fa fa-check"></i><b>7.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><i class="fa fa-check"></i><b>8</b> How to identify points inside and outside the fundamental niche</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#parameters-4"><i class="fa fa-check"></i><b>8.0.1</b> Parameters</a></li>
<li class="chapter" data-level="8.0.2" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#input-and-output-5"><i class="fa fa-check"></i><b>8.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="8.0.3" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#dependencies-5"><i class="fa fa-check"></i><b>8.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="8.1" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#worked-examples-5"><i class="fa fa-check"></i><b>8.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#read-source-code-and-library-1"><i class="fa fa-check"></i><b>8.1.1</b> Read source code and library</a></li>
<li class="chapter" data-level="8.1.2" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#threnetes-ruckeri-3"><i class="fa fa-check"></i><b>8.1.2</b> <em>Threnetes ruckeri</em></a></li>
<li class="chapter" data-level="8.1.3" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#catasticta-nimbice-4"><i class="fa fa-check"></i><b>8.1.3</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="8.1.4" data-path="how-to-identify-points-inside-and-outside-the-fundamental-niche.html"><a href="how-to-identify-points-inside-and-outside-the-fundamental-niche.html#theoretical-example"><i class="fa fa-check"></i><b>8.1.4</b> Theoretical Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><i class="fa fa-check"></i><b>9</b> Weighted-normal model: accounting for the uneven availability of environmental conditions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#how-the-functions-work"><i class="fa fa-check"></i><b>9.1</b> How the functions work</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#parameters-5"><i class="fa fa-check"></i><b>9.1.1</b> Parameters</a></li>
<li class="chapter" data-level="9.1.2" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#input-and-output-6"><i class="fa fa-check"></i><b>9.1.2</b> Input and Output</a></li>
<li class="chapter" data-level="9.1.3" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#dependencies-6"><i class="fa fa-check"></i><b>9.1.3</b> Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#worked-examples-6"><i class="fa fa-check"></i><b>9.2</b> Worked examples</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#read-sources-and-libraries"><i class="fa fa-check"></i><b>9.2.1</b> Read sources and libraries</a></li>
<li class="chapter" data-level="9.2.2" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#catasticta-nimbice-5"><i class="fa fa-check"></i><b>9.2.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="9.2.3" data-path="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html"><a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html#threnetes-ruckeri-4"><i class="fa fa-check"></i><b>9.2.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html"><i class="fa fa-check"></i><b>10</b> Projecting an estimated niche into G-space</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#parameters-6"><i class="fa fa-check"></i><b>10.0.1</b> Parameters</a></li>
<li class="chapter" data-level="10.0.2" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#input-and-output-7"><i class="fa fa-check"></i><b>10.0.2</b> Input and Output</a></li>
<li class="chapter" data-level="10.0.3" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#dependencies-7"><i class="fa fa-check"></i><b>10.0.3</b> Dependencies</a></li>
<li class="chapter" data-level="10.1" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#worked-examples-7"><i class="fa fa-check"></i><b>10.1</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#read-source-code-and-libraries-4"><i class="fa fa-check"></i><b>10.1.1</b> Read source code and libraries</a></li>
<li class="chapter" data-level="10.1.2" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#catasticta-nimbice-6"><i class="fa fa-check"></i><b>10.1.2</b> <em>Catasticta nimbice</em></a></li>
<li class="chapter" data-level="10.1.3" data-path="projecting-an-estimated-niche-into-g-space.html"><a href="projecting-an-estimated-niche-into-g-space.html#threnetes-ruckeri-5"><i class="fa fa-check"></i><b>10.1.3</b> <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html"><i class="fa fa-check"></i><b>11</b> Evaluation method: building accumulation curve of occurrences</a>
<ul>
<li class="chapter" data-level="11.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#calculate-the-accumulation-curve"><i class="fa fa-check"></i><b>11.1</b> Calculate the accumulation curve</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#parameters-7"><i class="fa fa-check"></i><b>11.1.1</b> Parameters</a></li>
<li class="chapter" data-level="11.1.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#input-and-output-8"><i class="fa fa-check"></i><b>11.1.2</b> Input and Output</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#worked-examples-8"><i class="fa fa-check"></i><b>11.2</b> Worked Examples</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#read-libraries-and-source-codes"><i class="fa fa-check"></i><b>11.2.1</b> Read libraries and source codes</a></li>
<li class="chapter" data-level="11.2.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#catasticta-nimbice-with-three-environmental-layers"><i class="fa fa-check"></i><b>11.2.2</b> <em>Catasticta nimbice</em> with three environmental layers</a></li>
<li class="chapter" data-level="11.2.3" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#threnetes-ruckeri-with-two-environmental-layers"><i class="fa fa-check"></i><b>11.2.3</b> <em>Threnetes ruckeri</em> with two environmental layers</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#comparing-the-accumulation-curves"><i class="fa fa-check"></i><b>11.3</b> Comparing the accumulation curves</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#parameters-8"><i class="fa fa-check"></i><b>11.3.1</b> Parameters</a></li>
<li class="chapter" data-level="11.3.2" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#input-and-output-9"><i class="fa fa-check"></i><b>11.3.2</b> Input and Output</a></li>
<li class="chapter" data-level="11.3.3" data-path="evaluation-method-building-accumulation-curve-of-occurrences.html"><a href="evaluation-method-building-accumulation-curve-of-occurrences.html#worked-example-threnetes-ruckeri"><i class="fa fa-check"></i><b>11.3.3</b> Worked example: <em>Threnetes ruckeri</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html"><i class="fa fa-check"></i><b>12</b> Bayesian model: adding tolerance limits</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#how-the-main-functions-work"><i class="fa fa-check"></i><b>12.1</b> How the main functions work</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#parameters-9"><i class="fa fa-check"></i><b>12.1.1</b> Parameters</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#input-and-output-10"><i class="fa fa-check"></i><b>12.1.2</b> Input and Output</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#dependencies-8"><i class="fa fa-check"></i><b>12.1.3</b> Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#worked-example-threnetes-ruckeri-1"><i class="fa fa-check"></i><b>12.2</b> Worked Example: <em>Threnetes ruckeri</em></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#read-source-codes-and-libraries"><i class="fa fa-check"></i><b>12.2.1</b> Read source codes and libraries</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#main-code"><i class="fa fa-check"></i><b>12.2.2</b> Main code</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#using-the-bayesian-model-for-the-projection-into-g-space"><i class="fa fa-check"></i><b>12.3</b> Using the Bayesian model for the projection into G-Space</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="bayesian-model-adding-tolerance-limits.html"><a href="bayesian-model-adding-tolerance-limits.html#read-source-and-libraries"><i class="fa fa-check"></i><b>12.3.1</b> Read source and libraries</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Index</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="projecting-an-estimated-niche-into-g-space" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Projecting an estimated niche into G-space</h1>
<p>The function <code>niche.G</code> projects ellipses that define suitable environments for a species on a raster map. Those potential niches in the geographical space are colored by different degrees of suitability. The calculation is based on the Mahalanobis distance (for further explanation, see tutorial “Mahalanobis model”).</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">niche.G</span>(Estck, mu, Sigma)</span></code></pre></div>
<div id="parameters-6" class="section level3" number="10.0.1">
<h3><span class="header-section-number">10.0.1</span> Parameters</h3>
<ul>
<li><p><code>Estck</code> = a raster stack with more than two climatic layers</p></li>
<li><p><code>mu</code> = the mean of the columns that contain environmental data, such as temperature and precipitation</p></li>
<li><p><code>Sigma</code> = the covariance of the environmental data linked with a species’ occurrence</p></li>
</ul>
</div>
<div id="input-and-output-7" class="section level3" number="10.0.2">
<h3><span class="header-section-number">10.0.2</span> Input and Output</h3>
<p>The function needs raster files with environmental layers and a matrix with occurrence data of a species that correlates with environmental variables. The latter can be created by using the <code>get.Ecoord</code> function (see tutorial “Getting environmental values for the study sites”). This matrix can be replaced by a matrix that contains already calculated values using the Mahalanobis distance and weigthed normal distribution. This matrix can be created by using the function <code>fitNiche</code> (see tutorial “Weighted-normal model”). In case the result is to be plotted in ggplot, other files might be necessary, such as a shapefile that describes the study area or cropped rasters.</p>
<p>The function will produce a raster of areas that have suitable environmental conditions for a species. Those potential ecological niche regions are colored by different degrees of suitability. The output can be plotted and saved as TIF or ASCI file. Be aware that some older GIS program versions might have an issue with properly displaying the tif-file.</p>
</div>
<div id="dependencies-7" class="section level3" number="10.0.3">
<h3><span class="header-section-number">10.0.3</span> Dependencies</h3>
<p><strong>Function:</strong> <code>raster</code></p>
<p><strong>Examples:</strong> <code>sp</code>, <code>mvtnorm</code> (only needs to be installed),<code>ggplot2</code>, <code>ggpubr</code>, <code>rgdal</code></p>
</div>
<div id="worked-examples-7" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Worked Examples</h2>
<div id="read-source-code-and-libraries-4" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Read source code and libraries</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;.</span><span class="sc">\\</span><span class="st">Functions</span><span class="sc">\\</span><span class="st">nicheG.R&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb136-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb136-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb136-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span></code></pre></div>
</div>
<div id="catasticta-nimbice-6" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> <em>Catasticta nimbice</em></h3>
<p><strong>Input Files</strong></p>
<ul>
<li><p>bio1.asc</p></li>
<li><p>bio12.asc</p></li>
<li><p>Catasticta_nimbice_occ_GE.csv</p></li>
<li><p>Catasticta_nimbice.shp (and associated files)</p></li>
</ul>
<p>Read the rasters with environmental data and combine them into a rasterstack with two (or more layers).</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Read raster</span></span>
<span id="cb137-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb137-2" aria-hidden="true" tabindex="-1"></a>bio1 <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;./Initial_Data/bio1.asc&quot;</span>)</span>
<span id="cb137-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb137-3" aria-hidden="true" tabindex="-1"></a>bio12 <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;./Initial_Data/bio12.asc&quot;</span>)</span>
<span id="cb137-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the rasters into a RasterStack</span></span>
<span id="cb137-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb137-5" aria-hidden="true" tabindex="-1"></a>bios <span class="ot">&lt;-</span> <span class="fu">stack</span>(bio1,bio12)</span></code></pre></div>
<p>For the species’ occurrence points in correspondence with environmental data the “occ_GE.csv”-file that was created with <code>get.Ecoord</code> is used.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read table and omit columns with coordinates</span></span>
<span id="cb138-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb138-2" aria-hidden="true" tabindex="-1"></a>occ_E <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Generated_Data/Catasticta_nimbice_occ_GE.csv&quot;</span>,<span class="at">header=</span>T)[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span></code></pre></div>
<div id="apply-the-function-and-automatically-plot-with-basic-plot" class="section level4" number="10.1.2.1">
<h4><span class="header-section-number">10.1.2.1</span> Apply the function and automatically plot with basic plot</h4>
<p>Apply the function <code>niche.G</code> with the parameters <code>Estck</code>, <code>mu</code>, and <code>Sigma</code>. The results are plotted in the basic plot function.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb139-1" aria-hidden="true" tabindex="-1"></a>cn.result <span class="ot">&lt;-</span> <span class="fu">niche.G</span>(<span class="at">Estck =</span> bios, <span class="at">mu =</span> <span class="fu">colMeans</span>(occ_E), <span class="at">Sigma =</span> <span class="fu">cov</span>(occ_E))</span></code></pre></div>
<p>Save the raster output as TIF or ASCI file.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(cn.result,<span class="st">&quot;./Generated_Data/Catasticta_nimbice_maha_map.tif&quot;</span>, <span class="at">overwrite =</span> T)</span>
<span id="cb140-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co"># writeRaster(cn.result, &quot;./Generated_Data/Catasticta_nimbice_maha_map.asc&quot;, overwrite = T)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="Images/Catasticta_nimbice_maha_asci.png" alt=" Figure of the geographical space with suitable niches for *Catasticta nimbice* ." width="70%" />
<p class="caption">
Figure 4.1:  Figure of the geographical space with suitable niches for <em>Catasticta nimbice</em> .
</p>
</div>
</div>
<div id="apply-the-function-and-plot-with-ggplot" class="section level4" number="10.1.2.2">
<h4><span class="header-section-number">10.1.2.2</span> Apply the function and plot with ggplot</h4>
<p>Another way to use the function <code>niche.G</code> is to use estimated values of <code>mu</code> and <code>Sigma</code> directly. The rasters with environmental data are cropped to the region of interest with a polygon before being stacked together in this version. They can also be cropped with coordinates (see the example for <em>Threnetes ruckeri</em> below).</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read polygon of the study area</span></span>
<span id="cb141-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb141-2" aria-hidden="true" tabindex="-1"></a>cn.shp <span class="ot">&lt;-</span> <span class="fu">readOGR</span>(<span class="st">&quot;./Initial_Data/shapefiles&quot;</span>,<span class="st">&quot;Catasticta_nimbice&quot;</span>)</span>
<span id="cb141-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crop and mask the rasters with environmental layers</span></span>
<span id="cb141-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb141-5" aria-hidden="true" tabindex="-1"></a>bio1c <span class="ot">&lt;-</span> <span class="fu">mask</span>(<span class="fu">crop</span>(bio1, cn.shp), cn.shp)</span>
<span id="cb141-6"><a href="projecting-an-estimated-niche-into-g-space.html#cb141-6" aria-hidden="true" tabindex="-1"></a>bio12c <span class="ot">&lt;-</span> <span class="fu">mask</span>(<span class="fu">crop</span>(bio12, cn.shp), cn.shp)</span>
<span id="cb141-7"><a href="projecting-an-estimated-niche-into-g-space.html#cb141-7" aria-hidden="true" tabindex="-1"></a>biosc <span class="ot">&lt;-</span> <span class="fu">stack</span>(bio1c, bio12c)</span></code></pre></div>
<p>For this application, the values for <code>mu</code>and <code>Sigma</code> from the weighted normal distribution model are used directly.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb142-1" aria-hidden="true" tabindex="-1"></a>cn.wn <span class="ot">&lt;-</span> <span class="fu">niche.G</span>(<span class="at">Estck =</span> biosc, <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">166.1297518</span>,<span class="fl">1265.130825</span>), </span>
<span id="cb142-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb142-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1427.054608</span>, <span class="fl">7687.724366</span>, </span>
<span id="cb142-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb142-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="fl">7687.724366</span>, <span class="fl">332940.0973</span>),<span class="at">ncol=</span><span class="dv">2</span>))</span></code></pre></div>
<p>Write the raster of the model as file (additionally, the cropped environmental layers can be saved as well for later use).</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(cn.wn,<span class="st">&quot;./Generated_Data/Catasticta_nimbice_wn_map.tif&quot;</span>, <span class="at">overwrite =</span> T)</span>
<span id="cb143-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># writeRaster(cn.wn, &quot;./Generated_Data/Catasticta_nimbice_wn_map.asc&quot;, overwrite = T)</span></span></code></pre></div>
<p>Plot the results in a ggplot.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate raster to points for ggplot</span></span>
<span id="cb144-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-2" aria-hidden="true" tabindex="-1"></a>cn.wnp <span class="ot">&lt;-</span> <span class="fu">rasterToPoints</span>(cn.wn)</span>
<span id="cb144-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-3" aria-hidden="true" tabindex="-1"></a>cn.wnpd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(cn.wnp)</span>
<span id="cb144-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cn.wnpd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>,<span class="st">&quot;Suitability&quot;</span>)</span>
<span id="cb144-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co"># read species occurrence points</span></span>
<span id="cb144-7"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-7" aria-hidden="true" tabindex="-1"></a>occ_GE <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Generated_Data/Catasticta_nimbice_occ_GE.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb144-8"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co"># x11()</span></span>
<span id="cb144-10"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb144-11"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> cn.wnpd,<span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, <span class="at">fill=</span>Suitability)) <span class="sc">+</span></span>
<span id="cb144-12"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb144-13"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#borders(&quot;world&quot;, xlim = c(-179, 179), ylim = c(-60, 80)) +</span></span>
<span id="cb144-14"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="st">&quot;Suitability&quot;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">low =</span> <span class="st">&#39;grey80&#39;</span>,</span>
<span id="cb144-15"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid=</span><span class="st">&#39;slateblue1&#39;</span>, <span class="at">high =</span> <span class="st">&#39;slateblue4&#39;</span>,<span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb144-16"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">n.breaks=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb144-17"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_sf(xlim = emap[1:2], ylim = emap[3:4], expand = FALSE) +</span></span>
<span id="cb144-18"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> occ_GE,<span class="fu">aes</span>(<span class="at">x=</span>occ_GE[,<span class="dv">1</span>], <span class="at">y=</span>occ_GE[,<span class="dv">2</span>]), </span>
<span id="cb144-19"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;orange1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb144-20"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Catasticta nimbice occurrences in Middle America&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-21"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;and suitable niches based on the weighted normal distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb144-22"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb144-23"><a href="projecting-an-estimated-niche-into-g-space.html#cb144-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p>Save the ggplot as PNG.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&#39;./Generated_Data/Catasticta_nimbice_wn_map_ggplot.png&#39;</span>,  <span class="at">width =</span> <span class="dv">24</span>, <span class="at">height =</span> <span class="dv">24</span>, </span>
<span id="cb145-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb145-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">pointsize =</span> <span class="dv">6</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="Images/Catasticta_nimbice_nicheG_ggplot.png" alt=" Figure of the geographical space with suitable niches for *Catasticta nimbice* and presence points ." width="70%" />
<p class="caption">
Figure 10.1:  Figure of the geographical space with suitable niches for <em>Catasticta nimbice</em> and presence points .
</p>
</div>
<p><br />
</p>
<p><strong>Output files</strong></p>
<ul>
<li><p>Catasticta_nimbice_maha_map.tif</p></li>
<li><p>Catasticta_nimbice_maha_map.asc</p></li>
<li><p><span style="color: red;">cn_maha_cropped.tif</span></p></li>
<li><p>Catasticta_nimbice_wn_map.tif</p></li>
<li><p>Catasticta_nimbice_wn_map.asc</p></li>
<li><p><span style="color: red;">tr_wn_cropped.tif</span></p></li>
<li><p>Catasticta_nimbice_wn_map_ggplot.png</p></li>
</ul>
</div>
</div>
<div id="threnetes-ruckeri-5" class="section level3" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> <em>Threnetes ruckeri</em></h3>
<p><strong>Input Files</strong></p>
<ul>
<li><p>bio1.asc</p></li>
<li><p>bio12.asc</p></li>
<li><p>tr_mu_sigma_estimates.csv</p></li>
<li><p>Threnetes_ruckeri_occ_GE.csv</p></li>
</ul>
<p>This example uses the Mahalanobis distance and the weighted normal distribution. The graphs are plotted in <code>ggplot2</code>. The raster files used here are the same as the ones used for the <em>Catasticta nimbice</em> examples.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Read raster files</span></span>
<span id="cb146-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bio1 &lt;- raster(&quot;./Initial_Data/bio1.asc&quot;)</span></span>
<span id="cb146-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bio2 &lt;- raster(&quot;./Initial_Data/bio12.asc&quot;)</span></span>
<span id="cb146-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb146-4" aria-hidden="true" tabindex="-1"></a>bios <span class="ot">&lt;-</span> <span class="fu">stack</span>(bio1,bio2)</span></code></pre></div>
<p>Load the matrix results of the weighted normal distribution that was calculated with the functions <code>rs.inE</code>, <code>negloglike</code>, and <code>fitNiche</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb147-1" aria-hidden="true" tabindex="-1"></a>thr.fitN <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Generated_Data/tr_mu_sigma_estimates.csv&quot;</span>,<span class="at">header=</span>T)[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Apply the function with <code>Estck</code>, <code>mu</code>, and <code>Sigma</code> for each, the weighted normal distribution and the Mahalanobis distance model.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weighted normal distribution</span></span>
<span id="cb148-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb148-2" aria-hidden="true" tabindex="-1"></a>Thr.wn <span class="ot">&lt;-</span> <span class="fu">niche.G</span>(<span class="at">Estck =</span> bios, <span class="at">mu =</span> thr.fitN<span class="sc">$</span>wn.mu, </span>
<span id="cb148-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb148-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Sigma =</span> <span class="fu">cbind</span>(thr.fitN<span class="sc">$</span>wn.sigma1, thr.fitN<span class="sc">$</span>wn.sigma2))</span>
<span id="cb148-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mahalanobis distance</span></span>
<span id="cb148-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb148-5" aria-hidden="true" tabindex="-1"></a>Thr.maha <span class="ot">&lt;-</span> <span class="fu">niche.G</span>(<span class="at">Estck =</span> bios, <span class="at">mu =</span> thr.fitN<span class="sc">$</span>maha.mu, </span>
<span id="cb148-6"><a href="projecting-an-estimated-niche-into-g-space.html#cb148-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Sigma =</span> <span class="fu">cbind</span>(thr.fitN<span class="sc">$</span>maha.sigma1, thr.fitN<span class="sc">$</span>maha.sigma2))</span></code></pre></div>
<p>Save the output as TIF or ASCI file.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weigthed normal distribution</span></span>
<span id="cb149-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(Thr.wn,<span class="st">&quot;./Generated_Data/Threnetes_ruckeri_wn_map.tif&quot;</span>, <span class="at">overwrite =</span> T)</span>
<span id="cb149-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># writeRaster(Thr.wn, &quot;./Generated_Data/Threnetes_ruckeri_wn_map.asc&quot;, overwrite = T)</span></span>
<span id="cb149-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mahalanobis distance</span></span>
<span id="cb149-6"><a href="projecting-an-estimated-niche-into-g-space.html#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(Thr.maha,<span class="st">&quot;./Generated_Data/Threnetes_ruckeri_maha_map.tif&quot;</span>, <span class="at">overwrite =</span> T)</span>
<span id="cb149-7"><a href="projecting-an-estimated-niche-into-g-space.html#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># writeRaster(Thr.maha, &quot;./Generated_Data/Threnetes_ruckeri_maha_map.asc&quot;, overwrite = T)</span></span></code></pre></div>
<p><strong>Plot both models next to each other in a ggplot</strong></p>
<p>Load the previously created tif-file with the suitability levels for the Mahalanobis distance model and the weighted normal distribution model or directly apply the results.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb150-1" aria-hidden="true" tabindex="-1"></a>maha.map <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;./Generated_Data/Threnetes_ruckeri_maha_map.tif&quot;</span>)</span>
<span id="cb150-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb150-3" aria-hidden="true" tabindex="-1"></a>wn.map <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;./Generated_Data/Threnetes_ruckeri_wn_map.tif&quot;</span>)</span></code></pre></div>
<p>Convert the raster to points and create a data-frame for ggplot. Name the columns of the new data-frame.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for Mahalanobis model</span></span>
<span id="cb151-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-2" aria-hidden="true" tabindex="-1"></a>maha.mappt <span class="ot">&lt;-</span> <span class="fu">rasterToPoints</span>(maha.map)</span>
<span id="cb151-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-3" aria-hidden="true" tabindex="-1"></a>outp.maha <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(maha.mappt)</span>
<span id="cb151-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(outp.maha) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>,<span class="st">&quot;Suitability&quot;</span>)</span>
<span id="cb151-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for weighted normal model</span></span>
<span id="cb151-7"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-7" aria-hidden="true" tabindex="-1"></a>wn.mappt <span class="ot">&lt;-</span> <span class="fu">rasterToPoints</span>(wn.map)</span>
<span id="cb151-8"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-8" aria-hidden="true" tabindex="-1"></a>outp.wn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(wn.mappt)</span>
<span id="cb151-9"><a href="projecting-an-estimated-niche-into-g-space.html#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(outp.wn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>,<span class="st">&quot;Suitability&quot;</span>)</span></code></pre></div>
<p>Plot in ggplot.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb152-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> outp.maha,<span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, <span class="at">fill=</span>Suitability)) <span class="sc">+</span></span>
<span id="cb152-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb152-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="st">&quot;Suitability&quot;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">low =</span> <span class="st">&#39;grey80&#39;</span>,</span>
<span id="cb152-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid=</span><span class="st">&#39;slateblue1&#39;</span>, <span class="at">high =</span> <span class="st">&#39;slateblue4&#39;</span>,<span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb152-6"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">n.breaks=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb152-7"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Mahalanobis distance model&quot;</span>) <span class="sc">+</span></span>
<span id="cb152-8"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb152-9"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-10"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb152-11"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> outp.wn,<span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, <span class="at">fill=</span>Suitability)) <span class="sc">+</span></span>
<span id="cb152-12"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb152-13"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="st">&quot;Suitability&quot;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">low =</span> <span class="st">&#39;grey80&#39;</span>,</span>
<span id="cb152-14"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid=</span><span class="st">&#39;slateblue1&#39;</span>, <span class="at">high =</span> <span class="st">&#39;slateblue4&#39;</span>,<span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb152-15"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">n.breaks=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb152-16"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Weighted normal distribution model&quot;</span>) <span class="sc">+</span></span>
<span id="cb152-17"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb152-18"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-19"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-19" aria-hidden="true" tabindex="-1"></a><span class="co"># x11()</span></span>
<span id="cb152-20"><a href="projecting-an-estimated-niche-into-g-space.html#cb152-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-22"></span>
<img src="Images/Threnetes_ruckeri_nicheG_ggplot.png" alt=" Figure of the geographical space with suitable niches for *Threnetes ruckeri* using the Mahalanobis distance model and the weigthed normal distribution model in `ggplot2`." width="100%" />
<p class="caption">
Figure 10.2:  Figure of the geographical space with suitable niches for <em>Threnetes ruckeri</em> using the Mahalanobis distance model and the weigthed normal distribution model in <code>ggplot2</code>.
</p>
</div>
<p>Plot a raster that has been cropped by coordinates in ggplot. This crop serves as a zoom to the region of interest.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read occurrence data of species</span></span>
<span id="cb153-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-2" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Generated_Data/Threnetes_ruckeri_occ_GE.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb153-3"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define coordinates that describe the study area and crop model raster with it</span></span>
<span id="cb153-5"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-5" aria-hidden="true" tabindex="-1"></a>emap <span class="ot">&lt;-</span> <span class="fu">extent</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="sc">-</span><span class="dv">68</span>, <span class="sc">-</span><span class="dv">8</span>, <span class="dv">22</span>)</span>
<span id="cb153-6"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-6" aria-hidden="true" tabindex="-1"></a>area.maha <span class="ot">&lt;-</span> <span class="fu">crop</span>(maha.map, emap)</span>
<span id="cb153-7"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-7" aria-hidden="true" tabindex="-1"></a>area.wn <span class="ot">&lt;-</span> <span class="fu">crop</span>(wn.map, emap)</span>
<span id="cb153-8"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-9"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create points from the raster and give column names</span></span>
<span id="cb153-10"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-10" aria-hidden="true" tabindex="-1"></a>maha.mappt <span class="ot">&lt;-</span> <span class="fu">rasterToPoints</span>(area.maha)</span>
<span id="cb153-11"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-11" aria-hidden="true" tabindex="-1"></a>outp.maha <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(maha.mappt)</span>
<span id="cb153-12"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(outp.maha) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>,<span class="st">&quot;Suitability&quot;</span>)</span>
<span id="cb153-13"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-14"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-14" aria-hidden="true" tabindex="-1"></a>wn.mappt <span class="ot">&lt;-</span> <span class="fu">rasterToPoints</span>(area.wn)</span>
<span id="cb153-15"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-15" aria-hidden="true" tabindex="-1"></a>outp.wn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(wn.mappt)</span>
<span id="cb153-16"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(outp.wn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>,<span class="st">&quot;Suitability&quot;</span>)</span>
<span id="cb153-17"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-18"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot both maps into one graph</span></span>
<span id="cb153-19"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-19" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb153-20"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> outp.maha,<span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, <span class="at">fill=</span>Suitability)) <span class="sc">+</span></span>
<span id="cb153-21"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb153-22"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="st">&quot;Suitability&quot;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">low =</span> <span class="st">&#39;grey80&#39;</span>,</span>
<span id="cb153-23"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid=</span><span class="st">&#39;slateblue1&#39;</span>, <span class="at">high =</span> <span class="st">&#39;slateblue4&#39;</span>,<span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb153-24"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">n.breaks=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb153-25"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> species,<span class="fu">aes</span>(<span class="at">x=</span>species[,<span class="dv">1</span>], <span class="at">y=</span>species[,<span class="dv">2</span>]), </span>
<span id="cb153-26"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;orange1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb153-27"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Mahalanobis distance model&quot;</span>) <span class="sc">+</span></span>
<span id="cb153-28"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb153-29"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-30"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-30" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb153-31"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> outp.wn,<span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, <span class="at">fill=</span>Suitability)) <span class="sc">+</span></span>
<span id="cb153-32"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb153-33"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="st">&quot;Suitability&quot;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">low =</span> <span class="st">&#39;grey80&#39;</span>,</span>
<span id="cb153-34"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid=</span><span class="st">&#39;slateblue1&#39;</span>, <span class="at">high =</span> <span class="st">&#39;slateblue4&#39;</span>,<span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb153-35"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">n.breaks=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb153-36"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> species,<span class="fu">aes</span>(<span class="at">x=</span>species[,<span class="dv">1</span>], <span class="at">y=</span>species[,<span class="dv">2</span>]), </span>
<span id="cb153-37"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;orange1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb153-38"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Weighted normal distribution model&quot;</span>) <span class="sc">+</span></span>
<span id="cb153-39"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb153-40"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-41"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-41" aria-hidden="true" tabindex="-1"></a><span class="co"># x11()</span></span>
<span id="cb153-42"><a href="projecting-an-estimated-niche-into-g-space.html#cb153-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="Images/Threnetes_ruckeri_nicheG_ggplot2.png" alt=" Figure of the geographical space with suitable niches for *Threnetes ruckeri* using the Mahalanobis distance model and the weigthed normal distribution model in `ggplot2`." width="100%" />
<p class="caption">
Figure 10.3:  Figure of the geographical space with suitable niches for <em>Threnetes ruckeri</em> using the Mahalanobis distance model and the weigthed normal distribution model in <code>ggplot2</code>.
</p>
</div>
<p>Save the plot as a PNG.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="projecting-an-estimated-niche-into-g-space.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&#39;./Generated_Data/Threnetes_ruckeri_nicheG_ggplot.png&#39;</span>,  <span class="at">width =</span> <span class="dv">48</span>, <span class="at">height =</span> <span class="dv">24</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb154-2"><a href="projecting-an-estimated-niche-into-g-space.html#cb154-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">pointsize =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><br />
</p>
<p><strong>Output Files</strong></p>
<ul>
<li><p>Threnetes_ruckeri_wn_map.tif</p></li>
<li><p>Threnetes_ruckeri_wn_map.asc</p></li>
<li><p><span style="color: red;">tr_wn_cropped.tif</span></p></li>
<li><p>Threnetes_ruckeri_maha_map.tif</p></li>
<li><p>Threnetes_ruckeri_maha_map.asc</p></li>
<li><p><span style="color: red;">tr_bay_cropped.tif</span></p></li>
<li><p>Threnetes_ruckeri_nicheG_ggplot.png</p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="weighted-normal-model-accounting-for-the-uneven-availability-of-environmental-conditions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="evaluation-method-building-accumulation-curve-of-occurrences.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
